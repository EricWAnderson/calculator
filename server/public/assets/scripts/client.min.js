/*! calculator 2016-04-25 */
var app=angular.module("calculator",["ngRoute"]),socket=io();app.config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"views/calculator.html",controller:"CalcController",controllerAs:"calc"}),b.html5Mode(!0)}]),app.controller("CalcController",["Calculator","mySocket",function(a,b){this.title="Calculator",this.title2="Last 10 calculations",this.data=a.data,this.math=a.math,this.numberClick=a.numberClick,this.results=b.data}]),app.factory("mySocket",["$timeout",function(a){var b={resultArray:[]};return socket.on("results",function(c){a(function(){b.resultArray=c}),console.log("new resultsArray is",b.resultArray)}),{data:b}}]),app.factory("Calculator",["$location","mySocket",function(a,b){var c={resultString:"",resultArray:[],secondNumberString:"",firstNumber:0,secondNumber:0,result:0,operator:!1,divide:!1,multiply:!1,subtract:!1,add:!1},d={divide:function(){0==c.operator&&(c.resultString+="รท",c.operator=!0,c.divide=!0)},multiply:function(){0==c.operator&&(c.resultString+="x",c.operator=!0,c.multiply=!0)},subtract:function(){0==c.operator&&(c.resultString+="-",c.operator=!0,c.subtract=!0)},add:function(){0==c.operator&&(c.resultString+="+",c.operator=!0,c.add=!0)},calc:function(){1==c.add?(c.result=c.firstNumber+c.secondNumber,c.resultString+="="+c.result,this.addResult(),this.clear()):1==c.subtract?(c.result=c.firstNumber-c.secondNumber,c.resultString+="="+c.result,this.addResult(),this.clear()):1==c.multiply?(c.result=c.firstNumber*c.secondNumber,c.resultString+="="+c.result,this.addResult(),this.clear()):1==c.divide?(c.result=c.firstNumber/c.secondNumber,c.resultString+="="+c.result,this.addResult(),this.clear()):console.log("you need an operator!")},addResult:function(){c.resultArray=b.data.resultArray,c.resultArray.unshift(c.resultString),c.resultArray.length>10&&c.resultArray.pop(),socket.emit("results",c.resultArray)},clear:function(){c.resultString="",c.secondNumberString="",c.firstNumber=0,c.secondNumber=0,c.result=0,c.operator=!1,c.divide=!1,c.multiply=!1,c.subtract=!1,c.add=!1}};return numberClick=function(a){1==c.operator&&c.firstNumber>0?(c.secondNumberString+=a,c.secondNumber=parseFloat(c.secondNumberString),c.resultString+=a):(c.resultString+=a,c.firstNumber=parseFloat(c.resultString))},{numberClick:numberClick,math:d,data:c}}]);